datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

enum UserType {
  UNDERGRADUATE
  COMPANY
}

enum InterestStatus {
  SAVED
  PENDING
  ACCEPTED
  REJECTED
}

model User {
  id String @id @default(cuid())
  email String @unique
  password String
  salt String
  userType UserType
  // Undergraduate User
  undergraduate Undergraduate?
  undergraduateId String?
  // Company User
  company Company?
  companyId String?
}

model Undergraduate {
  id String @id @default(cuid())
  name String
  surname String
  university String
  department String
  userId String @unique
  user User @relation(fields: [userId], references: [id])
  // Undergraduate accepted internships
  acceptedInternships Internship[]
  // Undergraduate intersts in internships
  interests Interest[]
}

model Company {
  id String @id @default(cuid())
  name String
  city String
  street String
  district String
  streetNumber String
  userId String @unique
  user User @relation(fields: [userId], references: [id])
  // Internships from company
  internships Internship[]
}

model Internship {
  id String @id @default(cuid())
  title String
  field String
  employment String
  duration String
  espa Boolean
  salary String
  description String
  // The company that created the internship
  companyId String
  company Company @relation(fields: [companyId], references: [id])
  // Accepted undergraduate
  undergraduateId String?
  undergraduate Undergraduate? @relation(fields: [undergraduateId], references: [id])
  // Interests for the internship
  interests Interest[]
}

model Interest {
  id String @id @default(cuid())
  // Status of the interest
  status InterestStatus
  // Undergraduate's interest for internship
  undergraduateId String
  undergraduate Undergraduate @relation(fields: [undergraduateId], references: [id])
  // The internship that undergraduate has interest
  internshipId String
  internship Internship @relation(fields: [internshipId], references: [id])
  // Unique pairing of undergraduate and internship
  @@unique([undergraduateId, internshipId])
}
        